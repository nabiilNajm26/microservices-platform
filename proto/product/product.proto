syntax = "proto3";

package product;

option go_package = "github.com/nabiilNajm26/microservices-platform/proto/product";

import "google/protobuf/timestamp.proto";

service ProductService {
    rpc CreateProduct(CreateProductRequest) returns (CreateProductResponse);
    rpc GetProduct(GetProductRequest) returns (GetProductResponse);
    rpc ListProducts(ListProductsRequest) returns (ListProductsResponse);
    rpc UpdateInventory(UpdateInventoryRequest) returns (UpdateInventoryResponse);
    rpc CheckInventory(CheckInventoryRequest) returns (CheckInventoryResponse);
}

message Product {
    string id = 1;
    string sku = 2;
    string name = 3;
    string description = 4;
    string category_id = 5;
    double base_price = 6;
    bool is_active = 7;
    google.protobuf.Timestamp created_at = 8;
    google.protobuf.Timestamp updated_at = 9;
    ProductInventory inventory = 10;
}

message ProductInventory {
    string product_id = 1;
    int32 quantity_available = 2;
    int32 quantity_reserved = 3;
    int32 low_stock_threshold = 4;
    google.protobuf.Timestamp updated_at = 5;
}

message CreateProductRequest {
    string sku = 1;
    string name = 2;
    string description = 3;
    string category_id = 4;
    double base_price = 5;
    int32 initial_inventory = 6;
}

message CreateProductResponse {
    Product product = 1;
}

message GetProductRequest {
    string product_id = 1;
}

message GetProductResponse {
    Product product = 1;
}

message ListProductsRequest {
    int32 page = 1;
    int32 limit = 2;
    string category_id = 3;
    double min_price = 4;
    double max_price = 5;
    bool in_stock_only = 6;
}

message ListProductsResponse {
    repeated Product products = 1;
    PaginationInfo pagination = 2;
}

message PaginationInfo {
    int32 current_page = 1;
    int32 total_pages = 2;
    int32 total_items = 3;
    int32 items_per_page = 4;
    bool has_next = 5;
    bool has_previous = 6;
}

message UpdateInventoryRequest {
    string product_id = 1;
    int32 quantity_change = 2;
    string operation = 3; // "add" or "subtract"
}

message UpdateInventoryResponse {
    ProductInventory inventory = 1;
}

message CheckInventoryRequest {
    string product_id = 1;
}

message CheckInventoryResponse {
    ProductInventory inventory = 1;
    bool in_stock = 2;
}